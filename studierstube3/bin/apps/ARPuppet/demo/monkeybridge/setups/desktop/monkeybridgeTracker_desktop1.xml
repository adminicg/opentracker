<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE OpenTracker SYSTEM "../../../../../../workspace/opentracker.dtd">

<OpenTracker>

    <configuration>
        <ARToolKitConfig camera-parameter="firefly_istvan.dat" videomode="inputDevive=WDM_CAP,videoWidth=640,videoHeight=480" framerate="100" treshhold="100"/>
        <ConsoleConfig headerline="Monkeybridge distributed desktop tracker - user0" interval="1" display="on"/>
        <!--TimeConfig display="true"/-->
    </configuration>

    <!-- playfield pose calibration -->
    <StbSink station="0" event="on">
        <ConsoleSink comment="playfield_pose_calibration" active="on" DEF="PLAYFIELD_POSE0">
            <EventDynamicTransform baseevent="true">
                <StbKeyboardSource number="0"/>
                <TransformBase>
                    <EventVirtualTransform rotationtype="axisangle" rotation="1 0 0 1.57079633">
                        <EventTransform scale="0.001 0.001 0.001" rotation="1 0 0 0">
                            <ARToolKitSource center="0 0" size="900 900" tag-file="4x4_f.patt"/>
                        </EventTransform>
                    </EventVirtualTransform>
                </TransformBase>
            </EventDynamicTransform>
        </ConsoleSink>
    </StbSink>

    <!-- first interaction marker -->
    <StbSink station="1" event="on">
        <ConsoleSink comment="cursor0" active="on" DEF="USER_MARKER0">
            <EventVirtualTransform rotationtype="axisangle" rotation="1 0 0 1.57079633">
                <EventTransform scale="0.001 0.001 0.001" rotation="1 0 0 0">
                    <ARToolKitSource center="0 0" size="140 140" tag-file="4x4_c.patt"/>
                </EventTransform>
            </EventVirtualTransform>
        </ConsoleSink>
    </StbSink>
    <!-- first interaction marker's relative pose to playfield pose - send over via network -->
    <NetworkSink name="cursor_nw_sink" number="1" multicast-address="224.15.15.15" port="12345">
        <EventDynamicTransform baseevent="true">
            <Ref USE="USER_MARKER0"/>
            <TransformBase>
                <EventInvertTransform>
                    <Ref USE="PLAYFIELD_POSE0"/>
                </EventInvertTransform>
            </TransformBase>
        </EventDynamicTransform>
    </NetworkSink>

    <!-- second interaction marker -->
    <StbSink station="2" event="on">
        <ConsoleSink comment="cursor1" active="on">
            <EventDynamicTransform baseevent="true">
                <Ref USE="PLAYFIELD_POSE0"/>
                <TransformBase>
                    <NetworkSource number="1" multicast-address="224.15.15.15" port="12346"/>
                </TransformBase>
            </EventDynamicTransform>
        </ConsoleSink>
    </StbSink>

    <!-- fix camera position -->
    <StbSink station="3" event="on">
        <ConsoleSink comment="camera_position" active="on">
            <TestSource position="0 0 0"/>
        </ConsoleSink>
    </StbSink>

</OpenTracker>
