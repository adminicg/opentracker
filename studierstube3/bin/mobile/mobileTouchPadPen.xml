<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XML Spy v4.0.1 U (http://www.xmlspy.com) by Luftgeist (Vienna University of Technology) -->
<!--This OpenTracker file describes the configuration for the mobile setup using a pen and tablet interface.
It supports the following hardware :
1) Intersense InterTrax2 to track head orientation
2) Firewire Webcam via ARToolkit to track markers on PIP and pen.
3) Wacom Graphire tablet for 2D pen input and buttons
4) Parallel port button-->
<!DOCTYPE OpenTracker SYSTEM "opentracker.dtd">
<OpenTracker>
	<configuration>
		<ARToolKitConfig camera-parameter="data/pyrofirewire.dat" videomode="0 320 240 vertical" framerate="15" treshhold="110"/>
		<ConsoleConfig headerline="Mobile User" interval="1" display="off"/>
		<InterSenseConfig>
			<ISTracker id="0"/>
		</InterSenseConfig>
	</configuration>
	<ConsoleSink comment="InterTrax" active="off">
		<EventVirtualOrientationTransform rotationtype="matrix" rotation="0 0 1 -1 0 0 0 -1 0" DEF="orientation">
			<EventOrientationTransform rotation="0 -1 0 0 0 -1 1 0 0" rotationtype="matrix">
				<InterSenseSource id="0"/>
			</EventOrientationTransform>
		</EventVirtualOrientationTransform>
	</ConsoleSink>
	<FileSink file="testout" station="0">
		<ConsoleSink comment="PIP" active="on">
			<StbSink station="0" DEF="Pad">
				<EventDynamicTransform baseevent="false">
					<TransformBase>
						<Ref USE="orientation"/>
					</TransformBase>
					<Selection timeout="10000">
						<Select>
							<ThresholdFilter rotationmax="1" rotationmin="0.1" DEF="PadReference">
								<Filter weight="0.333333 0.333333 0.333333">
									<EventQueue length="3">
										<EventVirtualTransform rotation="0 0 0.75 -0.75">
											<EventVirtualTransform rotation="0 1 0 0">
												<EventTransform rotation="0 1 0 0">
													<EventTransform rotation="1 0 0 0" scale="0.001 0.001 0.001">
														<ARToolKitSource tag-file="data/lambda.tag" center="0 0" size="50 50"/>
													</EventTransform>
												</EventTransform>
											</EventVirtualTransform>
										</EventVirtualTransform>
									</EventQueue>
								</Filter>
							</ThresholdFilter>
						</Select>
						<TestSource position="0 0 -10"/>
					</Selection>
				</EventDynamicTransform>
			</StbSink>
		</ConsoleSink>
	</FileSink>
	<ConsoleSink comment="Pen" active="off">
		<StbSink station="1" DEF="Pen">
			<EventDynamicTransform baseevent="false">
				<TransformBase>
					<Ref USE="orientation"/>
				</TransformBase>
				<Selection timeout="2000">
					<Select>
						<Merge>
							<MergeDefault>
								<EventTransform DEF="PenOptical">
									<EventTransform scale="0.001 0.001 0.001" translation="0 0 0" rotation="0 0 1 3.141592" rotationtype="axisangle">
										<EventTransform>
											<EventVirtualTransform rotation="0.5 0.5 0.5 0.5" translation=" 0 0 -160">
												<Merge>
													<MergeDefault>
														<EventVirtualTransform rotation=" .5029917380  .5014279870  -.5012367275  .4942985235" translation="-.2220118280 -32.48160126 -30.22296535">
															<ConfidenceFilter treshhold="0.8">
																<ARToolKitSource tag-file="data/pen1.tag" center="0 0" size="50"/>
															</ConfidenceFilter>
														</EventVirtualTransform>
														<EventVirtualTransform rotation=".1448792950e-1 -.7084267620 .9970575100e-2 .7055651710" translation="-20.74213547 -.1527992500 -42.24638883">
															<ConfidenceFilter treshhold="0.8">
																<ARToolKitSource tag-file="data/pen2.tag" center="0 0" size="50"/>
															</ConfidenceFilter>
														</EventVirtualTransform>
														<EventVirtualTransform rotation="  -.5174423930 -.5068315460 .4897498800 .4853042437" translation="-26.27967831 -1.187149700 -34.71511463">
															<ConfidenceFilter treshhold="0.8">
																<ARToolKitSource tag-file="data/pen3.tag" center="0 0" size="50"/>
															</ConfidenceFilter>
														</EventVirtualTransform>
														<EventVirtualTransform rotation=" .5002492600  -.5056980505  -.4930002224 .5009699995" translation="-28.95919523 .7681099400 -35.91970237">
															<ConfidenceFilter treshhold="0.8">
																<ARToolKitSource tag-file="data/pen4.tag" center="0 0" size="50"/>
															</ConfidenceFilter>
														</EventVirtualTransform>
														<ConfidenceFilter treshhold="0.8">
															<ARToolKitSource tag-file="data/pen5.tag" center="0 0" size="50"/>
														</ConfidenceFilter>
													</MergeDefault>
												</Merge>
											</EventVirtualTransform>
										</EventTransform>
									</EventTransform>
								</EventTransform>
							</MergeDefault>
							<MergeButton>
								<ButtonOp op="OR">
									<Arg1>
										<ParButtonSource dev="0x378" DEF="ParallelButton"/>
									</Arg1>
									<Arg2>
										<StbKeyboardSource number="0"/>
									</Arg2>
								</ButtonOp>
							</MergeButton>
						</Merge>
					</Select>
					<TestSource position="0 0 -10"/>
				</Selection>
			</EventDynamicTransform>
		</StbSink>
	</ConsoleSink>
	<!--<ConsoleSink comment="Viewpoint">-->
	<StbSink station="2">
		<EventDynamicTransform>
			<TransformBase>
				<Ref USE="orientation"/>
			</TransformBase>
			<!-- old camera on the helmet offset             
           <EventTransform translation=" -0.004 -0.148  0" rotation="-.9096828073e-1 -.4448448893e-2 -.4868302496e-1 .9946531794">
                <TestSource frequency="10"/>
            </EventTransform>-->
			<!-- <ConsoleSink comment="offset">
                <StbKeyboardSource number="1"/>
            </ConsoleSink>-->
			<!-- current camera in front of the eye offset -->
			<TestSource position="0 0 -0.072" frequency="10"/>
		</EventDynamicTransform>
	</StbSink>
	<!-- Special 2D input for tablet UI -->
	<!--</ConsoleSink>-->
	<ConsoleSink comment="new extra feature">
		<StbSink station="3" event="on">
			<EventDynamicTransform baseevent="true">
				<TransformBase>
					<Ref USE="Pad"/>
				</TransformBase>
				<EventTransform scale="-0.15 -0.1 0" translation="0.075 0.05 -0.005" rotation="0 0 0 1">
					<ButtonOp op="OR">
						<Arg1>
							<StbMouseSource DEF="PenWacom" mode="relative"/>
						</Arg1>
						<Arg2>
							<Ref USE="ParallelButton"/>
						</Arg2>
					</ButtonOp>
				</EventTransform>
			</EventDynamicTransform>
		</StbSink>
	</ConsoleSink>
</OpenTracker>
