<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SoSubAction.h Source File</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
</head><body><table width="100%">
<tr>
  <td>
    <img src="Coin_logo.png" alt="Coin Logo">
  </td>
  <td align="right">
    <a href="http://www.sim.no">http://www.sim.no</a><br>
    <a href="http://www.coin3d.org/">http://www.coin3d.org</a>
  </td>
</tr>
</table>
<hr noshade>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>SoSubAction.h</h1><pre class="fragment"><div>00001 <span class="preprocessor">#ifndef COIN_SOSUBACTION_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define COIN_SOSUBACTION_H</span>
00003 <span class="preprocessor"></span>
00004 <span class="comment">/**************************************************************************\</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> *  This file is part of the Coin 3D visualization library.</span>
00007 <span class="comment"> *  Copyright (C) 1998-2004 by Systems in Motion.  All rights reserved.</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> *  This library is free software; you can redistribute it and/or</span>
00010 <span class="comment"> *  modify it under the terms of the GNU General Public License</span>
00011 <span class="comment"> *  ("GPL") version 2 as published by the Free Software Foundation.</span>
00012 <span class="comment"> *  See the file LICENSE.GPL at the root directory of this source</span>
00013 <span class="comment"> *  distribution for additional information about the GNU GPL.</span>
00014 <span class="comment"> *</span>
00015 <span class="comment"> *  For using Coin with software that can not be combined with the GNU</span>
00016 <span class="comment"> *  GPL, and for taking advantage of the additional benefits of our</span>
00017 <span class="comment"> *  support services, please contact Systems in Motion about acquiring</span>
00018 <span class="comment"> *  a Coin Professional Edition License.</span>
00019 <span class="comment"> *</span>
00020 <span class="comment"> *  See &lt;URL:http://www.coin3d.org/&gt; for more information.</span>
00021 <span class="comment"> *</span>
00022 <span class="comment"> *  Systems in Motion, Teknobyen, Abels Gate 5, 7030 Trondheim, NORWAY.</span>
00023 <span class="comment"> *  &lt;URL:http://www.sim.no/&gt;.</span>
00024 <span class="comment"> *</span>
00025 <span class="comment">\**************************************************************************/</span>
00026 
00027 <span class="preprocessor">#ifndef COIN_INTERNAL</span>
00028 <span class="preprocessor"></span><span class="comment">// Added to be Inventor compliant.</span>
00029 <span class="preprocessor">#include &lt;Inventor/SbString.h&gt;</span>
00030 <span class="preprocessor">#include &lt;Inventor/actions/SoAction.h&gt;</span>
00031 <span class="preprocessor">#else // !COIN_INTERNAL</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#include &lt;Inventor/SbName.h&gt;</span>
00033 <span class="preprocessor">#include &lt;Inventor/actions/SoSubActionP.h&gt;</span>
00034 <span class="preprocessor">#endif // COIN_INTERNAL</span>
00035 <span class="preprocessor"></span>
00036 
00037 <span class="preprocessor">#define SO_ACTION_ADD_METHOD(_nodeclass_, _method_) \</span>
00038 <span class="preprocessor">  do { \</span>
00039 <span class="preprocessor">    addMethod(_nodeclass_::getClassTypeId(), (SoActionMethod)_method_); \</span>
00040 <span class="preprocessor">  } while (0)</span>
00041 <span class="preprocessor"></span>
00042 
00043 <span class="preprocessor">#define SO_ACTION_CONSTRUCTOR(_classname_) \</span>
00044 <span class="preprocessor">  do { \</span>
00045 <span class="preprocessor">    _classname_::traversalMethods = this-&gt;methods; \</span>
00046 <span class="preprocessor">  } while (0)</span>
00047 <span class="preprocessor"></span>
00048 
00049 <span class="preprocessor">#define SO_ACTION_HEADER(_classname_) \</span>
00050 <span class="preprocessor">public: \</span>
00051 <span class="preprocessor">  virtual SoType getTypeId(void) const; \</span>
00052 <span class="preprocessor">  static SoType getClassTypeId(void); \</span>
00053 <span class="preprocessor"> \</span>
00054 <span class="preprocessor">  static void addMethod(const SoType type, SoActionMethod method); \</span>
00055 <span class="preprocessor"> \</span>
00056 <span class="preprocessor">  static void enableElement(const SoType type, const int stackindex); \</span>
00057 <span class="preprocessor"> \</span>
00058 <span class="preprocessor">protected: \</span>
00059 <span class="preprocessor">  virtual const SoEnabledElementsList &amp; getEnabledElements(void) const; \</span>
00060 <span class="preprocessor">  </span><span class="comment">/* These two methods are not available in the original OIV API. */</span> \
00061   <span class="comment">/* They have been added as a work-around for Win32 DLL headaches. */</span> \
00062   <span class="comment">/* See further explanation below. 20000808 mortene. */</span> \
00063   static SoEnabledElementsList * getClassEnabledElements(void); \
00064   static SoActionMethodList * getClassActionMethods(void); \
00065  \
00066 private: \
00067   <span class="comment">/* The enabledElements and methods variables are protected in */</span> \
00068   <span class="comment">/* the original OIV API. This is not such a good idea, since */</span> \
00069   <span class="comment">/* exposed static class member variables is a major grievance */</span> \
00070   <span class="comment">/* with regard to Win32 DLLs. */</span> \
00071   static void atexit_cleanup(void); \
00072   static SoEnabledElementsList * enabledElements; \
00073   static SoActionMethodList * methods; \
00074   static SoType classTypeId
00075 
00076 
00077 <span class="preprocessor">#define SO_ACTION_SOURCE(_classname_) \</span>
00078 <span class="preprocessor">SoEnabledElementsList * _classname_::enabledElements = NULL; \</span>
00079 <span class="preprocessor">SoActionMethodList * _classname_::methods = NULL; \</span>
00080 <span class="preprocessor">SoEnabledElementsList * _classname_::getClassEnabledElements(void) { return _classname_::enabledElements; } \</span>
00081 <span class="preprocessor">SoActionMethodList * _classname_::getClassActionMethods(void) { return _classname_::methods; } \</span>
00082 <span class="preprocessor"></span><span class="comment">/* Don't set value explicitly to SoType::badType(), to avoid a bug in */</span> \
00083 <span class="comment">/* Sun CC v4.0. (Bitpattern 0x0000 equals SoType::badType()). */</span> \
00084 SoType _classname_::classTypeId; \
00085 SoType _classname_::getClassTypeId(void) { return _classname_::classTypeId; } \
00086 SoType _classname_::getTypeId(void) const { return _classname_::classTypeId; } \
00087 const SoEnabledElementsList &amp; _classname_::getEnabledElements(void) const \
00088 { \
00089   assert(_classname_::enabledElements); \
00090   return *_classname_::enabledElements; \
00091 } \
00092 void \
00093 _classname_::addMethod(const SoType type, SoActionMethod method) \
00094 { \
00095   assert(_classname_::methods); \
00096   _classname_::methods-&gt;addMethod(type, method); \
00097 } \
00098 void \
00099 _classname_::enableElement(const SoType type, const int stackindex) \
00100 { \
00101   assert(_classname_::enabledElements); \
00102   _classname_::enabledElements-&gt;enable(type, stackindex); \
00103 } \
00104 void \
00105 _classname_::atexit_cleanup(void) \
00106 { \
00107   delete _classname_::enabledElements; \
00108   _classname_::enabledElements = NULL; \
00109   delete _classname_::methods; \
00110   _classname_::methods = NULL; \
00111 }
00112 
00113 <span class="preprocessor">#define SO_ACTION_INIT_CLASS(_classname_, _parentclassname_) \</span>
00114 <span class="preprocessor">  do { \</span>
00115 <span class="preprocessor">    assert(_classname_::getClassTypeId() == SoType::badType()); \</span>
00116 <span class="preprocessor">    assert(_parentclassname_::getClassTypeId() != SoType::badType()); \</span>
00117 <span class="preprocessor">    _classname_::classTypeId = SoType::createType(_parentclassname_::getClassTypeId(), SO__QUOTE(_classname_)); \</span>
00118 <span class="preprocessor">    _classname_::enabledElements = new SoEnabledElementsList(_parentclassname_::getClassEnabledElements()); \</span>
00119 <span class="preprocessor">    _classname_::methods = new SoActionMethodList(_parentclassname_::getClassActionMethods()); \</span>
00120 <span class="preprocessor">  } while (0)</span>
00121 <span class="preprocessor"></span>
00122 <span class="preprocessor">#endif // !COIN_SOSUBACTION_H</span>
</div></pre><hr noshade>
<p align="right">Copyright &copy 1998-2004 by <a href="http://www.sim.no">Systems in Motion AS</a>. All rights reserved.</p>
<address style="align: right;"><small>
Generated on Mon Oct 18 01:24:31 2004 for Coin by <a href="http://www.doxygen.org/index.html">Doxygen.</a> 1.3.7</small></address>
</body>
</html>
